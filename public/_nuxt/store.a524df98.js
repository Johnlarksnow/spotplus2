import{a6 as w,k as c,A as f}from"./entry.0e2e8ba9.js";function d(e){this.message=e}d.prototype=new Error,d.prototype.name="InvalidCharacterError";var p=typeof window<"u"&&window.atob&&window.atob.bind(window)||function(e){var t=String(e).replace(/=+$/,"");if(t.length%4==1)throw new d("'atob' failed: The string to be decoded is not correctly encoded.");for(var n,r,o=0,a=0,i="";r=t.charAt(a++);~r&&(n=o%4?64*n+r:r,o++%4)?i+=String.fromCharCode(255&n>>(-2*o&6)):0)r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(r);return i};function g(e){var t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw"Illegal base64url string!"}try{return function(n){return decodeURIComponent(p(n).replace(/(.)/g,function(r,o){var a=o.charCodeAt(0).toString(16).toUpperCase();return a.length<2&&(a="0"+a),"%"+a}))}(t)}catch{return p(t)}}function u(e){this.message=e}function v(e,t){if(typeof e!="string")throw new u("Invalid token specified");var n=(t=t||{}).header===!0?0:1;try{return JSON.parse(g(e.split(".")[n]))}catch(r){throw new u("Invalid token specified: "+r.message)}}u.prototype=new Error,u.prototype.name="InvalidTokenError";const m=w("auth",()=>{const e=c(),t=c(),n=c();function r(){const s=f();i(),s.push("/")}function o(s){const h=f();e.value=s,h.push("/dashboard")}function a(){return v(e.value)}function i(){e.value="",t.value=void 0,n.value=""}function l(){return y(e.value)}return{jwt:e,signOut:r,signIn:o,decodeJwt:a,reset:i,checkJwt:l}},{persist:!0});function y(e){if(typeof e!="string")return!1;const t=e.split(".");if(t.length!==3)return!1;const n=JSON.parse(atob(t[0])),r=JSON.parse(atob(t[1]));if(typeof n!="object"||typeof r!="object"||typeof n.alg>"u")return!1;const o=Math.floor(Date.now()/1e3);return!(typeof r.exp<"u"&&r.exp<o)}export{m as u};
